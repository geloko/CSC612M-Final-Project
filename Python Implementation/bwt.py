import numpy as np
from datetime import datetime
from datetime import timedelta

input = "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$"
rotations = []

start_time = datetime.now()

# Step 1 - List all possible rotations of the string
for i in range(len(input)):
    rotations.append(input[i:] + input[:i])

# Step 2 - Sort the list of rotations in aphabetical/lexicographical order
bwt = sorted(rotations)
    
# Step 3 - Get the last characters of the sorted rotations
last_column = [row[-1:] for row in bwt]

dt = datetime.now() - start_time

print("Done!")
print("Runtime in seconds:", dt.seconds,".", dt.microseconds)
print("\nBWT:", "".join(last_column))

for i in range(len(input)):
    print(rotations[i])   

print('')

for i in range(len(input)):
    print(bwt[i])

substring = 'ana'

# Perform FM-Index compression
search = sorted(last_column)
for i in range(1, len(substring)):
    print("\nPass #", i)
    search = sorted(search)
    for j in range(len(last_column)):
        search[j] = last_column[j] + search[j]
        
    for j in range(len(search)):
        print(search[j])

# FM-Index Count - get the number of occurences of the substring within the compressed text
substring_count = search.count(substring)
print("\nNumber of substrings present:", substring_count)

# FM-Index Locate - locate the position(s) of the substring within the compressed text
substring_index = []
if(substring_count > 0):
    substring_index = [i for i, j in enumerate(search) if j == substring]
    print("Index/Indices where the substring is present:", substring_index)